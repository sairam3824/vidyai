"""
Seed initial CBSE Class 10 Mathematics curriculum.
Run once after migrations:  python scripts/seed_data.py
"""
from __future__ import annotations

import os
import sys

sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from app.database import SessionLocal
from app.models.board import Board, Chapter, Class, Subject

CBSE_MATH_CHAPTERS = [
    (1, "Real Numbers", "Euclid's division lemma, Fundamental Theorem of Arithmetic, irrationality of surds"),
    (2, "Polynomials", "Zeros of a polynomial, relationship between zeros and coefficients, division algorithm"),
    (3, "Pair of Linear Equations in Two Variables", "Graphical, substitution, elimination, and cross-multiplication methods"),
    (4, "Quadratic Equations", "Standard form, factorisation, completing the square, quadratic formula, discriminant"),
    (5, "Arithmetic Progressions", "AP, nth term formula, sum of first n terms, applications"),
    (6, "Triangles", "Similar triangles, Basic Proportionality Theorem, criteria for similarity, Pythagoras theorem"),
    (7, "Coordinate Geometry", "Distance formula, section formula, area of triangle using coordinates"),
    (8, "Introduction to Trigonometry", "Trigonometric ratios, values of specific angles, complementary angles, identities"),
    (9, "Some Applications of Trigonometry", "Heights and distances, angle of elevation, angle of depression"),
    (10, "Circles", "Tangent to a circle, number of tangents, theorems on tangents"),
    (11, "Areas Related to Circles", "Perimeter and area of circle, area of sector and segment"),
    (12, "Surface Areas and Volumes", "Combination of solids, conversion of solids, frustum of a cone"),
    (13, "Statistics", "Mean, median, mode of grouped data, cumulative frequency graphs"),
    (14, "Probability", "Classical probability definition, simple problems on single events"),
    (15, "PROOFS IN MATHEMATICS", "A1. Proofs in Mathematics"),
    (16, "MATHEMATICAL MODELLING", "A2. Mathematical Modelling"),
]


def seed() -> None:
    db = SessionLocal()
    try:
        if db.query(Board).filter(Board.code == "CBSE").first():
            print("✓ Seed data already exists — skipping.")
            return

        board = Board(
            name="Central Board of Secondary Education",
            code="CBSE",
            description="National-level board of education in India, controlled by the Government of India.",
        )
        db.add(board)
        db.flush()

        class_10 = Class(board_id=board.id, class_number=10, display_name="Class 10")
        db.add(class_10)
        db.flush()

        maths = Subject(class_id=class_10.id, subject_name="Mathematics", subject_code="MATH")
        db.add(maths)
        db.flush()

        for num, name, desc in CBSE_MATH_CHAPTERS:
            db.add(
                Chapter(
                    subject_id=maths.id,
                    chapter_number=num,
                    chapter_name=name,
                    description=desc,
                )
            )

        db.commit()
        print(f"✓ Seeded CBSE Class 10 Mathematics — {len(CBSE_MATH_CHAPTERS)} chapters.")
    except Exception as exc:
        db.rollback()
        print(f"✗ Seeding failed: {exc}")
        raise
    finally:
        db.close()


if __name__ == "__main__":
    seed()
